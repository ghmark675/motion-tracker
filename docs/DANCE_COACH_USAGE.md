# Dance Coach Demo - 使用指南

## 🎯 功能概述

Dance Coach 是一个跳舞动作对比教练，使用 DTW（动态时间规整）算法来对比你的动作和参考动作的相似度。

### 核心功能
- ✅ 录制标准动作作为参考
- ✅ 实时对比你的动作与参考动作
- ✅ 显示 8 个关节的实时偏差
- ✅ 计算整体评分（0-100分）
- ✅ 保存/加载参考动作

## 📝 完整使用流程

### 步骤 1: 启动程序

```bash
cd /Volumes/MindDockSSD/projects/opensource/motion-tracker
source venv/bin/activate
python demos/dance_coach_demo.py
```

### 步骤 2: 录制参考动作（标准动作）

1. **按 `r` 键** - 开始录制
   - 屏幕显示：`RECORDING REFERENCE: X frames`（红色）

2. **做一个舞蹈动作** - 例如：
   - 举手、转身、下蹲等
   - 建议 3-10 秒的连续动作
   - 确保动作流畅完整

3. **再按 `r` 键** - 停止录制
   - 终端显示：`[OK] Reference recorded: X frames`
   - 屏幕显示：`Reference ready: X frames`（绿色）

### 步骤 3: 练习模式（对比动作）

1. **按 `p` 键** - 开始练习模式
   - 屏幕显示：`PRACTICE MODE: X frames`（绿色）
   - 终端显示：`[OK] Practice mode started...`

2. **重复刚才的舞蹈动作**
   - 尽量模仿参考动作
   - **屏幕会实时显示反馈**：

   ```
   PRACTICE MODE: 45 frames

   [OK] Left Elbow: 5deg off        ← 偏差小于15度，很好！
   [~]  Right Shoulder: 18deg off   ← 偏差15-30度，还可以
   [!]  Left Knee: 35deg off        ← 偏差大于30度，需要改进
   [OK] Right Knee: 8deg off
   [OK] Left Hip: 12deg off
   [~]  Right Hip: 22deg off
   [OK] Left Shoulder: 7deg off
   [~]  Right Elbow: 19deg off
   ```

3. **再按 `p` 键** - 停止练习
   - **终端会打印详细评分**：

   ```
   ========================================
   DANCE COMPARISON RESULTS
   ========================================
   Overall Score: 85.3/100

   Joint Scores:
     Left Elbow          : 92.5/100
     Right Elbow         : 88.3/100
     Left Shoulder       : 91.2/100
     Right Shoulder      : 79.8/100
     Left Knee           : 85.6/100
     Right Knee          : 90.1/100
     Left Hip            : 83.4/100
     Right Hip           : 81.7/100
   ========================================
   ```

### 步骤 4: 再次练习（可选）

- 再按 `p` 开始新的练习
- 可以多次练习，每次都会得到新的评分
- 尝试提高你的分数！

## 🎮 所有控制键

| 按键 | 功能 |
|-----|------|
| `r` | 开始/停止录制参考动作 |
| `p` | 开始/停止练习模式 |
| `c` | 清除当前参考动作 |
| `s` | 保存参考动作到文件 |
| `l` | 从文件加载参考动作 |
| `q` | 退出程序 |

## 📊 评分系统

### 实时反馈（练习时）

- 🟢 `[OK]` - 偏差 < 15度：动作很准确
- 🟠 `[~]` - 偏差 15-30度：动作基本正确
- 🔴 `[!]` - 偏差 > 30度：需要调整

### 总体评分（练习结束后）

- **90-100 分**: 优秀！动作非常准确
- **80-89 分**: 良好，大部分动作到位
- **70-79 分**: 及格，但需要改进
- **< 70 分**: 动作差异较大，继续练习

## 🔧 高级功能

### 保存参考动作

如果你想保存一个很好的参考动作：

1. 录制参考动作（按 `r` 两次）
2. 按 `s` 保存
   - 会保存到 `dance_reference.pkl`
   - 终端显示：`[OK] Reference saved to dance_reference.pkl`

### 加载参考动作

下次使用时，可以直接加载：

1. 启动程序
2. 按 `l` 加载之前保存的参考动作
   - 终端显示：`[OK] Reference loaded from dance_reference.pkl`
3. 直接按 `p` 开始练习

### 清除参考动作

如果想录制新的参考动作：

1. 按 `c` 清除当前参考
2. 按 `r` 录制新的参考动作

## 🎬 使用示例

### 示例 1: 第一次使用

```bash
# 1. 启动程序
python demos/dance_coach_demo.py

# 2. 看到窗口后：
#    - 按 'r' 开始录制
#    - 举起双手 3 秒
#    - 按 'r' 停止

# 3. 练习模式：
#    - 按 'p' 开始
#    - 再次举起双手
#    - 看屏幕上的实时反馈
#    - 按 'p' 停止
#    - 查看终端的评分

# 4. 继续练习：
#    - 按 'p' 再来一次
#    - 尝试提高分数！
```

### 示例 2: 使用保存的参考

```bash
# 1. 启动程序
python demos/dance_coach_demo.py

# 2. 加载之前保存的参考动作：
#    - 按 'l' 加载
#    - 直接按 'p' 开始练习

# 3. 不满意参考动作？
#    - 按 'c' 清除
#    - 按 'r' 录制新的
#    - 按 's' 保存
```

## 🎯 建议的练习动作

### 简单动作（适合测试）
- ✋ 双手举起/放下
- 🙆 双手左右伸展
- 🧘 下蹲/起立
- 🤸 单腿站立

### 复杂动作（适合舞蹈）
- 💃 连续的舞蹈片段（5-8秒）
- 🕺 转身动作
- 🤸 连续的手部动作
- 💪 健身动作组合

## ❓ 常见问题

### Q1: 为什么只看到"RECORDING REFERENCE"？

A: 你只完成了第一步。需要：
1. 再按 `r` 停止录制
2. 按 `p` 开始练习模式

### Q2: 为什么没有看到评分？

A: 评分显示在**终端**中，不是屏幕上。需要：
1. 按 `p` 开始练习
2. 做完动作后，再按 `p` 停止
3. 在终端窗口查看评分结果

### Q3: 实时反馈不准确怎么办？

A: 可能的原因：
- 参考动作录制太短（建议 3 秒以上）
- 两次动作的速度差异太大
- 摄像头角度不同
- 光线条件变化

### Q4: 如何提高评分？

建议：
- 放慢动作速度，确保流畅
- 关节角度尽量和参考动作一致
- 保持相同的站立位置
- 多次练习熟悉参考动作

### Q5: DTW 算法是什么？

DTW（Dynamic Time Warping）= 动态时间规整
- 自动对齐不同速度的动作序列
- 即使你做得快一点或慢一点，也能准确对比
- 关注动作的形态，而不是时间

## 🔬 技术细节

### 对比的 8 个关节

- Left/Right Elbow（肘关节）
- Left/Right Shoulder（肩关节）
- Left/Right Knee（膝关节）
- Left/Right Hip（髋关节）

### 评分计算

1. 使用 DTW 算法计算每个关节的角度序列距离
2. 归一化为 0-100 分
3. 取 8 个关节的平均分作为总分

### 数据保存格式

- 文件格式：Pickle (`.pkl`)
- 保存内容：
  - 每帧的关节角度
  - 时间戳
  - 动作名称

---

**享受你的舞蹈练习！** 💃🕺
